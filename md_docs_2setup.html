<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PER Firmware: PER Firmware Setup Instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PER Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2setup.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PER Firmware Setup Instructions</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md58"></a></p>
<h1><a class="anchor" id="autotoc_md59"></a>
1. Tools</h1>
<p>The PER firmware development environment relies on several tools &ndash; such as <code>cmake</code>, <code>ninja</code>, and <code>stlink</code> &ndash; to build, debug, flash, and deploy code to the vehicle. To streamline setup, we (highly) recommend using a package manager compatible with your operating system. Package managers help manage dependencies and ensure tools are correctly installed and updated. Below are supported package manager setups for each OS (macOS, Windows, Linux):</p>
<h2><a class="anchor" id="autotoc_md60"></a>
MacOS Tools Setup</h2>
<ol type="1">
<li><a href="https://brew.sh/">Homebrew</a>: macOS package manager. Open a terminal (e.g., iTerm) and paste and run the installation command provided on the homebrew install page.<ul>
<li>After installing Homebrew, make sure to add /opt/homebrew/bin to your system’s PATH environment variable. The exact command should be printed at the end of the homebrew install.</li>
<li>After installation, ensure brew is installed by running: <code>brew --version</code></li>
</ul>
</li>
<li>Run the following commands in your terminal to install the other tools (you can copy and paste them all at once). <div class="fragment"><div class="line">brew install git cmake ninja openocd stlink python3</div>
<div class="line">brew install --cask gcc-arm-embedded</div>
</div><!-- fragment --></li>
<li>Download VSCode from the website: <a href="https://code.visualstudio.com/docs/setup/mac">https://code.visualstudio.com/docs/setup/mac</a></li>
</ol>
<h2><a class="anchor" id="autotoc_md61"></a>
Windows Tools Setup</h2>
<p>You should use WSL if possible, the choco toolchain for Windows is too old. Install <a href="https://learn.microsoft.com/en-us/windows/wsl/install">here</a>.</p>
<ol type="1">
<li>If you are using Ubuntu version, use the newest version as Ubuntu is a bit weird with package versions as well. You may need to update it.</li>
<li>Follow the Linux steps after this</li>
<li>VSCode should have good integration with WSL, you can use the windows version of VSCode with WSL extension.</li>
<li>You will have to setup USB on WSL (it is a bit weird). You can do this when you are done with onboarding, and you can build the repository. <a href="https://learn.microsoft.com/en-us/windows/wsl/connect-usb">Instructions</a></li>
</ol>
<p>Native Windows is still possible:</p><ol type="1">
<li><a href="https://chocolatey.org/install#install-step2">Chocolatey</a>: Windows package manager Paste and run the installation command provided on the Chocolatey install page.<ul>
<li>Open the Start Menu, scroll to W, and locate Windows PowerShell. Right-click on PowerShell and select "Run as Administrator".</li>
<li>After installation, confirm choco is installed by running: <code>choco --version</code></li>
</ul>
</li>
<li>In your administrator powershell, paste the following commands (right click to paste in powershell terminal).</li>
</ol>
<div class="fragment"><div class="line">choco install git cmake ninja python3 openocd </div>
</div><!-- fragment --><ul>
<li>Enter (<code>A</code>) on the first prompt to select 'Yes to All'</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Make sure to run these in PowerShell as Administrator!</dd></dl>
<ol type="1">
<li>STLink drivers need to be manually installed from <a href="https://www.st.com/en/development-tools/stsw-link009.html">here</a>.</li>
<li>gcc-arm-embedded needs to be manually installed from <a href="https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads">here</a> (Download and install arm-gnu-toolchain-15.2.rel1-mingw-w64-x86_64-arm-none-eabi.msi)</li>
<li>Download VSCode from the website: <a href="https://code.visualstudio.com/download">https://code.visualstudio.com/download</a></li>
</ol>
<h2><a class="anchor" id="autotoc_md62"></a>
Linux Tools Setup</h2>
<ol type="1">
<li>You probably already know what you're doing, so here are the commands for <code>apt</code> (Ubuntu, Debian, Pop!, etc.): <div class="fragment"><div class="line">sudo apt update &amp;&amp; sudo apt upgrade</div>
<div class="line">sudo apt install git cmake python3 python3-pip ninja-build gcc-arm-none-eabi openocd stlink-tools</div>
</div><!-- fragment --></li>
<li>Visual Studio Code requires some special attention, install from <a href="https://code.visualstudio.com/docs/setup/linux">here</a>.</li>
</ol>
<h1><a class="anchor" id="autotoc_md63"></a>
2. VSCode Setup (All OS)</h1>
<p>VS Code is the recommended editor for firmware development.</p>
<h2><a class="anchor" id="autotoc_md64"></a>
Install Extensions</h2>
<p>Open the Extensions view (Ctrl+Shift+X or Cmd+Shift+X) and install the <a href="https://marketplace.visualstudio.com/items?itemName=irvingywang.per-pack">PER extension pack</a> by searching the extension marketplace for "PER-Pack". </p><dl class="section warning"><dt>Warning</dt><dd>PER-Pack is required! Dont skip this step.</dd></dl>
<h2><a class="anchor" id="autotoc_md65"></a>
Turn on Autosave</h2>
<p>Go to <code>File -&gt; Autosave</code> and click check to turn on autosave.</p>
<h1><a class="anchor" id="autotoc_md66"></a>
3. Repository Setup (All OS)</h1>
<p>Follow these steps to download the PER codebase and get started on development:</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Open a new terminal</h2>
<p>Open a new terminal. Just use your regular user account.</p>
<p>For Windows, open your terminal or WSL.</p>
<p>You should land in your home directory: </p><div class="fragment"><div class="line">/home/{USER}</div>
</div><!-- fragment --><p>For MacOS: </p><div class="fragment"><div class="line">/Users/{username}</div>
</div><!-- fragment --><p>You can confirm with: </p><div class="fragment"><div class="line">pwd</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md68"></a>
Clone PER repo</h2>
<ol type="1">
<li>Once you're in your home directory, clone the PER firmware repository with the following command: <div class="fragment"><div class="line">git clone https://github.com/PurdueElectricRacing/firmware.git</div>
</div><!-- fragment --></li>
<li>Enter the firmware repository: <div class="fragment"><div class="line">cd firmware</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md69"></a>
Setup &amp; Build</h2>
<ol type="1">
<li>Install the required Python packages.</li>
</ol>
<p>You can install the dependencies in one of two ways:</p>
<p><b>Option A</b> — Use a virtual environment to isolate dependencies </p><div class="fragment"><div class="line">python3 -m venv .venv</div>
<div class="line">source .venv/bin/activate  # On Windows: .venv\Scripts\activate</div>
<div class="line">pip3 install -r requirements.txt</div>
</div><!-- fragment --><p> Before running any build commands, make sure to activate the virtual environment each time by running: </p><div class="fragment"><div class="line">source .venv/bin/activate  # On Windows: .venv\Scripts\activate</div>
</div><!-- fragment --><p><b>Option B (Simpler)</b> — Install directly to your system Python </p><div class="fragment"><div class="line">pip3 install -r requirements.txt</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>If you encounter an “externally managed environment” error when using Option B, run: <div class="fragment"><div class="line">pip3 install -r requirements.txt --break-system-packages</div>
</div><!-- fragment --></dd></dl>
<ol type="1">
<li>Launch Visual Studio Code: <div class="fragment"><div class="line">code .</div>
</div><!-- fragment --></li>
<li>Try running a build by doing <code>CTRL/CMD + Shift + B</code> in your VSCode window</li>
</ol>
<div class="fragment"><div class="line">Ctrl + Shift + B on Windows/Linux</div>
<div class="line">Cmd + Shift + B on macOS</div>
</div><!-- fragment --><p>All done! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
